"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),n=e(t),r=require("antd"),a=e(require("papaparse")),o=e(require("lodash/difference")),u=e(require("lodash/union")),l=e(require("lodash/get")),i=e(require("lodash/set")),c=e(require("lodash/debounce")),s=e(require("fuse.js"));function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t={};return null==e||e.forEach((function(e){var n,r=e.title,a=e.key,o=e.dataIndex,u=null!=(n=Array.isArray(o)?o.join("."):o)?n:a;u&&i(t,u,r)})),t},v=function(e){var i,c=e.dataSource,s=void 0===c?[]:c,d=e.fileName,f=e.fields,v=e.disabled,b=e.btnProps,y=e.columns,h=void 0===y?[]:y,m=e.showColumnPicker,g=void 0!==m&&m,j=n.useState(!1),x=j[0],S=j[1],O=null!=f?f:p(h),k=n.useState((function(){return f?Object.keys(f):h?Object.keys(p(h)):[]})),E=k[0],w=k[1];t.useEffect((function(){f?w(Object.keys(f)):h&&w(Object.keys(p(h)))}),[f,h]);var C=n.useCallback((function(){if(s){var e=Object.keys(O).filter((function(e){return E.indexOf(e)>-1})),t=function(e,t,n){if(!e||0===e.length)return{data:[],fields:[]};var r=[].concat(e),a=n.map((function(e){var n=l(t,e);return"string"==typeof n?n:n.header||""})),o=r.map((function(e,r){return n.map((function(n){var a=l(t,n),o=l(e,n);return"string"==typeof a?o:(null==a?void 0:a.formatter(o,e,r))||null}))}));return[a].concat(o)}(s,O,e),n=a.unparse(t,{greedy:!0,header:!1}),r=new Blob([n]),o=window.document.createElement("a");o.href=window.URL.createObjectURL(r),o.download=(d||"table")+".csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),S(!1)}}),[s,O,E,d]),A=n.useCallback((function(e,t){var n=[].concat(E);n=t?u(n,[e]):o(n,[e]),w(n)}),[E]);return n.createElement(t.Fragment,null,n.createElement(r.Button,Object.assign({onClick:function(){return g?S(!0):C()},disabled:v},b),null!=(i=e.children)?i:"Export to CSV"),g?n.createElement(r.Modal,{visible:x,onOk:function(){return C()},onCancel:function(){return S(!1)},width:400,okButtonProps:{disabled:E.length<1,title:E.length<1?"Please select at least one column.":null},okText:"Export",title:"Select columns to export"},n.createElement("div",{className:"d-flex flex-column align-start"},Object.entries(O).map((function(e){var t,a=e[0],o=e[1];return n.createElement(r.Checkbox,{key:a,style:{padding:0,margin:0},defaultChecked:!0,checked:E.indexOf(a)>-1,onChange:function(e){return A(a,e.target.checked)}},"string"==typeof o?o:null!=(t=null==o?void 0:o.header)?t:"")})))):null)},b=function(e,t){var n=null==e?void 0:e[0];return t.map((function(e){var t=e.dataIndex,r=e.children;if(r&&Array.isArray(r)){var a=function e(t,n){void 0===n&&(n=[]);for(var r,a=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(t.children);!(r=a()).done;){var o=r.value;if(o.children&&Array.isArray(o.children))n=e(o,n);else{if(!o.dataIndex)continue;if(Array.isArray(o.dataIndex)){n=[].concat(n,[o.dataIndex.join(".")]);continue}n=[].concat(n,[o.dataIndex])}}return n}(e,[]);return null==a?void 0:a.flat()}if(Array.isArray(t))return t.join(".");if(n&&"[object Object]"===Object.prototype.toString.call(n[t])&&"string"==typeof t)throw new Error("'"+t+"' is an object in dataSource. But dataIndex is given as string. If it is an object, use array of strings as dataIndex.");return t})).filter((function(e){return!!e})).flat(10).filter((function(e){return"string"==typeof e}))},y=function(e){var a=e.searchFunction,o=void 0===a?null:a,u=e.dataSource,l=e.setDataSource,i=e.debounce,f=void 0===i||i,p=e.inputProps,v=void 0===p?{placeholder:"Search..."}:p,y=e.fuzzySearch,h=void 0!==y&&y,m=e.columns,g=e.fuseProps,j=t.useState(""),x=j[0],S=j[1],O=t.useRef(),k=t.useRef(),E=n.useMemo((function(){return d({keys:b(u,m),threshold:h?.6:0},g)}),[g,u,m,h]),w=function(e,t){return void 0===t&&(t=""),""!==t&&k&&k.current?k.current.search(t).map((function(e){return e.item})):O.current},C=n.useCallback(c((function(e,t,n){var r=null==n?void 0:n(e,t);l(r)}),100,{leading:!1,trailing:!0}),[]);return t.useEffect((function(){u&&(O.current=[].concat(u),k.current=new s(u,E))}),[u,E]),t.useEffect((function(){if(u&&x)if(f)C(u,x,null!=o?o:w);else{var e,t=null!=(e=null==o?void 0:o(u,x))?e:w(0,x);l(t)}}),[x,u,C,o,l,f]),n.createElement(r.Input,Object.assign({value:x,onChange:function(e){var t=e.target.value;if(S(t),f)C(u,t,null!=o?o:w);else{var n,r=null!=(n=null==o?void 0:o(u,t))?n:w(0,t);l(r)}},placeholder:"Search...",allowClear:!0},v))};exports.ExportTableButton=v,exports.SearchTableInput=y,exports.Table=function(e){var a,o,u,l=e.exportable,i=void 0!==l&&l,c=e.exportableProps,s=e.searchable,f=void 0!==s&&s,p=e.searchableProps,b=e.dataSource,h=e.columns,m=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(a[n]=e[n]);return a}(e,["exportable","exportableProps","searchable","searchableProps","dataSource","columns"]),g=(o=t.useRef(!1),u=t.useCallback((function(){return o.current}),[]),t.useEffect((function(){return o.current=!0,function(){o.current=!1}})),u),j=i||c,x=f||p,S=t.useState(b),O=S[0],k=S[1];return t.useEffect((function(){x&&g()&&k(b)}),[x,b,g]),n.createElement("div",null,n.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:10}},j?n.createElement(v,Object.assign({dataSource:b,columns:h},c)):null,x?n.createElement(y,Object.assign({columns:h,dataSource:b,setDataSource:k},p,{inputProps:d({style:d({width:j?"60%":"100%"},null==p||null==(a=p.inputProps)?void 0:a.style)},null==p?void 0:p.inputProps)})):null),n.createElement(r.Table,Object.assign({dataSource:x?O:b,columns:h},m)))};
//# sourceMappingURL=ant-table-extensions.cjs.production.min.js.map
